# Домашнее задание к уроку 1: Основы PyTorch

## Цель задания
Закрепить навыки работы с тензорами PyTorch, изучить основные операции и научиться решать практические задачи.

## Задание 1: Создание и манипуляции с тензорами (25 баллов)

Создайте файл `homework_tensors.py` и выполните следующие задачи:

### 1.1 Создание тензоров (7 баллов)
```python
# Создайте следующие тензоры:
# - Тензор размером 3x4, заполненный случайными числами от 0 до 1
# - Тензор размером 2x3x4, заполненный нулями
# - Тензор размером 5x5, заполненный единицами
# - Тензор размером 4x4 с числами от 0 до 15 (используйте reshape)
```

### 1.2 Операции с тензорами (6 баллов)
```python
# Дано: тензор A размером 3x4 и тензор B размером 4x3
# Выполните:
# - Транспонирование тензора A
# - Матричное умножение A и B
# - Поэлементное умножение A и транспонированного B
# - Вычислите сумму всех элементов тензора A
```

### 1.3 Индексация и срезы (6 баллов)
```python
# Создайте тензор размером 5x5x5
# Извлеките:
# - Первую строку
# - Последний столбец
# - Подматрицу размером 2x2 из центра тензора
# - Все элементы с четными индексами
```

### 1.4 Работа с формами (6 баллов)
```python
# Создайте тензор размером 24 элемента
# Преобразуйте его в формы:
# - 2x12
# - 3x8
# - 4x6
# - 2x3x4
# - 2x2x2x3
```

## Задание 2: Автоматическое дифференцирование (25 баллов)

Создайте файл `homework_autograd.py`:

### 2.1 Простые вычисления с градиентами (8 баллов)
```python
# Создайте тензоры x, y, z с requires_grad=True
# Вычислите функцию: f(x,y,z) = x^2 + y^2 + z^2 + 2*x*y*z
# Найдите градиенты по всем переменным
# Проверьте результат аналитически
```

### 2.2 Градиент функции потерь (9 баллов)
```python
# Реализуйте функцию MSE (Mean Squared Error):
# MSE = (1/n) * Σ(y_pred - y_true)^2
# где y_pred = w * x + b (линейная функция)
# Найдите градиенты по w и b
```

### 2.3 Цепное правило (8 баллов)
```python
# Реализуйте составную функцию: f(x) = sin(x^2 + 1)
# Найдите градиент df/dx
# Проверьте результат с помощью torch.autograd.grad
```

## Задание 3: Сравнение производительности CPU vs CUDA (20 баллов)

Создайте файл `homework_performance.py`:

### 3.1 Подготовка данных (5 баллов)
```python
# Создайте большие матрицы размеров:
# - 64 x 1024 x 1024
# - 128 x 512 x 512
# - 256 x 256 x 256
# Заполните их случайными числами
```

### 3.2 Функция измерения времени (5 баллов)
```python
# Создайте функцию для измерения времени выполнения операций
# Используйте torch.cuda.Event() для точного измерения на GPU
# Используйте time.time() для измерения на CPU
```

### 3.3 Сравнение операций (10 баллов)
```python
# Сравните время выполнения следующих операций на CPU и CUDA:
# - Матричное умножение (torch.matmul)
# - Поэлементное сложение
# - Поэлементное умножение
# - Транспонирование
# - Вычисление суммы всех элементов

# Для каждой операции:
# 1. Измерьте время на CPU
# 2. Измерьте время на GPU (если доступен)
# 3. Вычислите ускорение (speedup)
# 4. Выведите результаты в табличном виде
```

### Пример вывода:
```
Операция          | CPU (мс) | GPU (мс) | Ускорение
Матричное умножение|   150.2  |    12.3  |   12.2x
Сложение          |    45.1  |     3.2  |   14.1x
...
```

### 3.4 Анализ результатов (5 баллов)
```python
# Проанализируйте результаты:
# - Какие операции получают наибольшее ускорение на GPU?
# - Почему некоторые операции могут быть медленнее на GPU?
# - Как размер матриц влияет на ускорение?
# - Что происходит при передаче данных между CPU и GPU?
```

## Дополнительные требования

1. **Код должен быть читаемым** - используйте комментарии и понятные имена переменных
2. **Обработка ошибок** - добавьте проверки размерностей и типов данных
3. **Документация** - добавьте docstring к функциям
4. **Тестирование** - проверьте результаты на простых примерах или напишите тесты
5. **Адаптивность** - код должен работать как с GPU, так и без него